# OTUS PRO Homework 29 DHCP PXE

## Домашняя работа 29: DHCP, PXE

### Домашнее задание:
**1. Подготовка рабочего места**   
**2. Настроить загрузку по сети дистрибутива Ubuntu 22**   
**3. Установка должна проходить из HTTP-репозитория**   
**4. Настроить автоматическую установку c помощью файла user-data**
5. Задания со звёздочкой*: Настроить автоматическую загрузку по сети дистрибутива Ubuntu 24 c использованием UEFI     
     
      
Формат сдачи ДЗ - vagrant + ansible  

---
## Выполнение задания:
### 1. Подготовка рабочего места:
Выполнение домашнего задания предполагает, что на компьютере установлен Vagrant+VirtualBox   
**[Как установить Vagrant на Debian 12](https://github.com/avlikh/Install_Vagrant_Debian12/blob/main/README.md)**   

Развернем Vagrant-стенд:
  - Создайте папку с проектом и зайдите в нее (например: /opt/otus/pxe):
```
mkdir -p /opt/otus/pxe ; cd /opt/otus/pxe
```
  - Клонируете проект с Github, набрав команду:
```
apt update -y && apt install git -y ; git clone https://github.com/avlikh/Otus_pro_29.git .
```
  - Запустите проект из папки, в которую склонировали проект (в нашем примере /opt/otus/pxe):
```
vagrant up
```
Результатом выполнения команды **vagrant up** станут созданные 2 виртуальные машины **pxeserver** (Ubuntu 22.04) и **pxeclient** (стартующий по сети).   

---
### 2. Настроить загрузку по сети дистрибутива Ubuntu 22**   
### 3. Установка должна проходить из HTTP-репозитория**     
     
После запуска команды vagrant up была настроена установка по сети дистрибутива Ubuntu 22.04.2 на клиете **pxeclient**. 
Для этого, Vagrant выполнил Ansible playbook **"provision.yml"** c тэгом **"pxe_manual"**    

**Зайдем в Virtialbox и убедимся, что на **pxeclient** запустилась сетевая установка Ubintu в ручносм режиме:**     
     
![image](https://github.com/user-attachments/assets/1af08c16-9f2d-4ab0-ad32-47372057663c)

### 4. Настроить автоматическую установку c помощью файла user-data**     
Выполним ansible playbook **"provision.yml"** c тэгом **"pxe_auto"**

```
ansible-playbook provision.yml --tags "pxe_auto"
```

<details>
<summary> результат выполнения команды: </summary>

```
root@deb4likh:/opt/otus/pxe# ansible-playbook provision.yml --tags "pxe_auto"

PLAY [PXE manual install] ***********************************************************************************************************************************************************************************************

PLAY [PXE Autoconfig] ***************************************************************************************************************************************************************************************************

TASK [Gathering Facts] **************************************************************************************************************************************************************************************************
ok: [pxeserver]

TASK [pxe_auto : Ensure /srv/ks directory exists] ***********************************************************************************************************************************************************************
ok: [pxeserver]

TASK [pxe_auto : copy /srv/ks/user-data] ********************************************************************************************************************************************************************************
ok: [pxeserver]

TASK [pxe_auto : Create /srv/ks/meta-data file] *************************************************************************************************************************************************************************
changed: [pxeserver]

TASK [pxe_auto : Create /srv/ks/vendor-data file] ***********************************************************************************************************************************************************************
changed: [pxeserver]

TASK [pxe_auto : copy /etc/apache2/sites-available/ks-server.conf] ******************************************************************************************************************************************************
changed: [pxeserver]

TASK [pxe_auto : copy /srv/tftp/amd64/pxelinux.cfg/default] *************************************************************************************************************************************************************
changed: [pxeserver]

TASK [pxe_auto : Restart dnsmasq service] *******************************************************************************************************************************************************************************
changed: [pxeserver]

TASK [pxe_auto : Restart apache2 service] *******************************************************************************************************************************************************************************
changed: [pxeserver]

PLAY RECAP **************************************************************************************************************************************************************************************************************
pxeserver                  : ok=9    changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```
</details>

Перезапустим виртуальную машину **pxeclient** используя графический интерфейс Virtualbox.    
Подождем окончания автоматической установки Ubuntu, выключим виртуальную машину **pxeclient** и поменяем параметры загрузки  **pxeclient** на загрузку с диска.    
Запустим виртуальную машину, и попробуем зайти в нее используя пользоваля **otus** с пароем **123**

![image](https://github.com/user-attachments/assets/5659aff8-49f5-4456-a87d-b5cd15396ce5)

**Условия домашнего задания выполнены.**
